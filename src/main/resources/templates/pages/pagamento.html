<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org">

<head>
    <link rel="stylesheet" th:href="@{/css/styles.css}" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
</head>
<div th:replace="pages/head :: head"></div>

<body>
    <div th:replace="pages/header :: header"></div>

    <section>
        <div class="container my-10">
            <div class="flex flex-wrap">
                <div class="w-6/12">
                    <!--<div th:replace="pages/passo :: passo"></div>-->


                    <div class="progress">
                        <div class="progress-bar" role="progressbar" style="width: 50%;" aria-valuenow="50"
                            aria-valuemin="0" aria-valuemax="100"></div>
                    </div>

                    <div class="flex justify-between my-4">
                        <h2 class="font-bold text-xl">
                            Método de pagamento
                        </h2>
                    </div>

                    <div>
                        <form th:action="@{/compra/detalhar}" th:object="${creditcard}" method="post"
                            class="flex flex-col">
                            <!-- Credit Card Radio Button -->
                            <div class="flex justify-between items-center">
                                <div class="flex">
                                    <input type="radio" id="creditCardRadio" class="w-5" name="paymentMethod">
                                    <div class="flex flex-col ml-3">
                                        <h2 class="font-medium">Cartao de crédito</h2>
                                    </div>
                                </div>
                                <img th:src="@{/img/pagamento.png}" alt="pagamento">
                            </div>

                            <!-- Credit Card Fields - initially hidden -->
                            <div class="creditCardFields" style="display:none;">
                                <!--<label class="font-bold">Selecione um Cartão.</label>-->
                                <select class="form-select" th:object="${creditcard}" name="selectedCartao"
                                    id="cartaoDropdown" onchange="updateFields()">
                                    <option value="" selected="selected">Selecione um Cartão:</option>
                                    <option th:each="creditcard : ${lista}" th:value="${creditcard.id}"
                                        th:data-numero="${creditcard.numeroCartao}"
                                        th:data-nome="${creditcard.nomeTitular}"
                                        th:data-validade="${creditcard.dataValidade}"
                                        th:data-codigo="${creditcard.codigoSeguranca}"
                                        th:data-bandeira="${creditcard.bandeira}" th:data-cpf="${creditcard.cpfTitular}"
                                        th:text="${creditcard.apelidoCartao}"></option>
                                </select>


                                <input class="my-3" placeholder="Número do Cartão" type="text" id="numeroCartaoInput"
                                    readonly />
                                <input placeholder="Nome do Titular" type="text" id="nomeTitularInput" readonly />
                                <input class="my-3" placeholder="dataValidade" type="text" id="dataValidadeInput"
                                    readonly />
                                <input placeholder="Código de Segurança" type="text" id="codigoSegurancaInput"
                                    readonly />
                                <input class="my-3" placeholder="Bandeira" type="text" id="bandeiraInput" readonly />
                                <input placeholder="CPF do Titular" type="text" id="cpfTitularInput" readonly />
                            </div>


                            <div class="flex my-5">
                                <input type="radio" class="w-5" name="paymentMethod">
                                <div class="flex flex-col ml-3">
                                    <h2 class="font-medium">Boleto bancário</h2>
                                </div>
                            </div>

                            <div class="flex">
                                <input type="radio" class="w-5" name="paymentMethod">
                                <div class="flex flex-col ml-3">
                                    <h2 class="font-medium">PIX</h2>
                                </div>
                            </div>

                            <div class="flex justify-between my-5 items-center  ">

                                <a href="#" class="hover:border-solid hover:border-2 hover:border-gray-dark px-1 py-1"
                                    th:href="@{/compra/iniciar}">Retornar</a>
                                <button
                                    class="bg-purple px-3 py-3 text-white hover:bg-black transition-all duration-500"
                                    type="submit">Continue</button>

                            </div>

                        </form>
                    </div>

                </div>

                <div class="w-6/12 pl-10">
                    <div th:replace="pages/roupascarrinho :: roupascarrinho"></div>
                </div>

            </div>
        </div>
    </section>


    <div th:replace="pages/footer :: footer"></div>

    <!-- JavaScript to toggle visibility of credit card fields -->
    <script>
        // Get all radio buttons with the name 'paymentMethod'
        var radioButtons = document.querySelectorAll('input[name="paymentMethod"]');

        // Function to toggle credit card fields
        function toggleCreditCardFields() {
            var creditCardFields = document.querySelector(".creditCardFields");
            var creditCardRadio = document.getElementById("creditCardRadio");
            if (creditCardRadio.checked) {
                creditCardFields.style.display = "block";
            } else {
                creditCardFields.style.display = "none";
            }
        }

        // Attach the function to the 'change' event for all radio buttons
        radioButtons.forEach(function (radio) {
            radio.addEventListener("change", toggleCreditCardFields);
        });
    </script>

    <script>
        function updateFields() {
            const dropdown = document.getElementById('cartaoDropdown');
            const selectedOption = dropdown.options[dropdown.selectedIndex];

            if (selectedOption.value === "") {
                // Clear all fields if empty option is selected
                document.getElementById('numeroCartaoInput').value = "";
                document.getElementById('nomeTitularInput').value = "";
                document.getElementById('dataValidadeInput').value = "";
                document.getElementById('codigoSegurancaInput').value = "";
                document.getElementById('bandeiraInput').value = "";
                document.getElementById('cpfTitularInput').value = "";
            } else {
                document.getElementById('numeroCartaoInput').value = selectedOption.getAttribute('data-numero');
                document.getElementById('nomeTitularInput').value = selectedOption.getAttribute('data-nome');
                document.getElementById('dataValidadeInput').value = selectedOption.getAttribute('data-validade');
                document.getElementById('codigoSegurancaInput').value = selectedOption.getAttribute('data-codigo');
                document.getElementById('bandeiraInput').value = selectedOption.getAttribute('data-bandeira');
                document.getElementById('cpfTitularInput').value = selectedOption.getAttribute('data-cpf');
            }
        }
    </script>

</body>

</html>